================================================================================
CATEGORY-PARTITION TESTING REPORT
Class: CategoriaDAO
Package: model.dao
================================================================================

### 1. CLASS OVERVIEW

Class name: CategoriaDAO
Package: model.dao

Role in the domain:
The CategoriaDAO class is a Data Access Object responsible for managing database 
operations related to the Categoria (Category) entity. It provides CRUD operations 
for categories including retrieval, insertion, and deletion.

Important fields:
- No instance fields (stateless DAO).
- Relies on ConPool for database connections.

Invariants:
- Database connection must be properly managed (opened and closed).
- All database operations must handle SQLException appropriately.
- Parameter validation occurs before database operations.
- null and empty string parameters are rejected with IllegalArgumentException.

================================================================================
### 2. METHODS TO BE TESTED
================================================================================

--------------------------------------------------------------------------------
#### 2.1 Constructor: CategoriaDAO()
--------------------------------------------------------------------------------

2.1.1. Parameters and relevant state

Explicit parameters:
- None

Relevant object state:
- None (default constructor creates fresh instance)

Preconditions:
- None explicit

Postconditions:
- A new CategoriaDAO instance is created
- The instance is ready to perform database operations

2.1.2. Categories and choices

Category C1 - Constructor invocation
  C1.a: Constructor is called successfully

2.1.3. Test frames (combinations of choices)

F1: Create new CategoriaDAO instance
  - Choices: C1.a
  - Expected behavior: New instance is created without exceptions
  - Return value: Non-null CategoriaDAO object

2.1.4. Suggested JUnit 5 test method names and structure

shouldCreateNewCategoriaDAOInstanceWhenConstructorCalled()
  - Arrange: None required
  - Act: CategoriaDAO dao = new CategoriaDAO();
  - Assert: assertNotNull(dao)

2.1.5. Parameterized test candidates
- Not applicable (simple constructor with no parameters)

--------------------------------------------------------------------------------
#### 2.2 Method: public ArrayList<Categoria> getCategorie() throws SQLException
--------------------------------------------------------------------------------

2.2.1. Parameters and relevant state

Explicit parameters:
- None

Relevant object state:
- Database connection availability
- Database state (number of categories in the categoria table)

Preconditions:
- Database connection can be obtained from ConPool
- categoria table exists and is accessible

Postconditions:
- Returns ArrayList<Categoria> containing all categories from the database
- Empty list if no categories exist
- Database connection is properly closed

2.2.2. Categories and choices

Category C1 - Database connection
  C1.a: Connection is successfully obtained
  C1.b: Connection fails (SQLException)

Category C2 - Database content
  C2.a: categoria table is empty
  C2.b: categoria table contains one category
  C2.c: categoria table contains multiple categories

Category C3 - SQL execution
  C3.a: SQL query executes successfully
  C3.b: SQL query fails (SQLException)

2.2.3. Test frames (combinations of choices)

F1: Retrieve categories from empty database
  - Choices: C1.a + C2.a + C3.a
  - Expected behavior: Returns empty ArrayList<Categoria>
  - Return value: Non-null, empty list (size == 0)

F2: Retrieve single category
  - Choices: C1.a + C2.b + C3.a
  - Expected behavior: Returns ArrayList with one Categoria object
  - Return value: List with size == 1
  - State: Categoria object has nomeCategoria set from database

F3: Retrieve multiple categories
  - Choices: C1.a + C2.c + C3.a
  - Expected behavior: Returns ArrayList with multiple Categoria objects
  - Return value: List with size > 1
  - State: All Categoria objects populated with data from database

F4: Database connection fails
  - Choices: C1.b
  - Expected behavior: SQLException is thrown
  - Exception: SQLException

F5: SQL execution fails
  - Choices: C1.a + C3.b
  - Expected behavior: SQLException is thrown
  - Exception: SQLException

2.2.4. Suggested JUnit 5 test method names and structure

shouldReturnEmptyListWhenNoCategoriesExist()
  - Arrange: Clear/empty categoria table in test database
  - Act: ArrayList<Categoria> result = dao.getCategorie();
  - Assert: 
    - assertNotNull(result)
    - assertEquals(0, result.size())

shouldReturnSingleCategoriaWhenOneCategoryExists()
  - Arrange: Insert one test category into database
  - Act: ArrayList<Categoria> result = dao.getCategorie();
  - Assert:
    - assertNotNull(result)
    - assertEquals(1, result.size())
    - assertEquals("TestCategory", result.get(0).getNomeCategoria())

shouldReturnAllCategoriesWhenMultipleCategoriesExist()
  - Arrange: Insert 3 test categories into database
  - Act: ArrayList<Categoria> result = dao.getCategorie();
  - Assert:
    - assertNotNull(result)
    - assertEquals(3, result.size())
    - Verify all category names are retrieved

shouldThrowSQLExceptionWhenDatabaseConnectionFails()
  - Arrange: Mock ConPool to throw SQLException
  - Act & Assert: assertThrows(SQLException.class, () -> dao.getCategorie())

2.2.5. Parameterized test candidates

Good candidate for parameterized tests to verify different database states:

CSV schema:
Columns: scenario, numberOfCategories, expectedSize
Example rows:
  "empty database", 0, 0
  "single category", 1, 1
  "multiple categories", 5, 5

--------------------------------------------------------------------------------
#### 2.3 Method: public int addCategoria(Categoria c) throws SQLException
--------------------------------------------------------------------------------

2.3.1. Parameters and relevant state

Explicit parameters:
- c: Categoria (the category to add)

Relevant object state:
- Database connection availability
- Current state of categoria table

Preconditions:
- c must not be null (enforced by IllegalArgumentException)
- Database connection must be available
- c.getNomeCategoria() must return valid string

Postconditions:
- If successful: Category is inserted into database
- Returns number of rows affected (typically 1)
- Database connection is properly closed

2.3.2. Categories and choices

Category C1 - Categoria parameter (c)
  C1.a: c == null (invalid)
  C1.b: c != null && c.getNomeCategoria() returns valid string
  C1.c: c != null BUT c.getNomeCategoria() returns null or empty (edge case)

Category C2 - Database connection
  C2.a: Connection is successfully obtained
  C2.b: Connection fails (SQLException)

Category C3 - Database state
  C3.a: Category with same name does not exist
  C3.b: Category with same name already exists (duplicate key violation)

Category C4 - SQL execution
  C4.a: INSERT executes successfully
  C4.b: INSERT fails (SQLException)

2.3.3. Test frames (combinations of choices)

F1: Add null category
  - Choices: C1.a
  - Expected behavior: IllegalArgumentException is thrown
  - Exception: IllegalArgumentException with message "La categoria non può essere null"

F2: Add valid new category
  - Choices: C1.b + C2.a + C3.a + C4.a
  - Expected behavior: Category is inserted successfully
  - Return value: 1 (one row affected)
  - State: Database contains the new category

F3: Add category with null or empty name
  - Choices: C1.c + C2.a
  - Expected behavior: Depends on Categoria bean validation
  - May throw SQLException or IllegalArgumentException from bean setter

F4: Add duplicate category
  - Choices: C1.b + C2.a + C3.b
  - Expected behavior: SQLException is thrown (duplicate key constraint)
  - Exception: SQLException

F5: Database connection fails
  - Choices: C1.b + C2.b
  - Expected behavior: SQLException is thrown
  - Exception: SQLException

2.3.4. Suggested JUnit 5 test method names and structure

shouldThrowIllegalArgumentExceptionWhenCategoriaIsNull()
  - Arrange: Categoria c = null;
  - Act & Assert: 
    - IllegalArgumentException ex = assertThrows(IllegalArgumentException.class, 
        () -> dao.addCategoria(c))
    - assertEquals("La categoria non può essere null", ex.getMessage())

shouldInsertCategoriaAndReturnOneWhenValidCategoriaProvided()
  - Arrange: 
    - Categoria c = new Categoria();
    - c.setNomeCategoria("Electronics");
  - Act: int result = dao.addCategoria(c);
  - Assert:
    - assertEquals(1, result)
    - Verify category exists in database

shouldThrowSQLExceptionWhenDuplicateCategoryAdded()
  - Arrange:
    - Insert category "Electronics" first
    - Categoria c = new Categoria();
    - c.setNomeCategoria("Electronics");
  - Act & Assert: assertThrows(SQLException.class, () -> dao.addCategoria(c))

shouldThrowSQLExceptionWhenDatabaseConnectionFails()
  - Arrange: 
    - Mock ConPool to throw SQLException
    - Categoria c = new Categoria();
    - c.setNomeCategoria("Test");
  - Act & Assert: assertThrows(SQLException.class, () -> dao.addCategoria(c))

2.3.5. Parameterized test candidates

Good candidate for testing various valid category names:

CSV schema:
Columns: categoryName, expectedResult
Example rows:
  "Electronics", 1
  "Books", 1
  "Clothing", 1

--------------------------------------------------------------------------------
#### 2.4 Method: public void eliminaCategoria(String nome) throws SQLException
--------------------------------------------------------------------------------

2.4.1. Parameters and relevant state

Explicit parameters:
- nome: String (name of the category to delete)

Relevant object state:
- Database connection availability
- Current state of categoria table

Preconditions:
- nome must not be null (enforced by IllegalArgumentException)
- nome must not be empty or whitespace-only (enforced by IllegalArgumentException)
- Database connection must be available

Postconditions:
- If successful: Category with given name is deleted from database
- Method returns void (no return value)
- Database connection is properly closed

2.4.2. Categories and choices

Category C1 - Nome parameter
  C1.a: nome == null (invalid)
  C1.b: nome is empty string "" (invalid)
  C1.c: nome is whitespace-only "   " (invalid)
  C1.d: nome is valid non-empty string

Category C2 - Database state
  C2.a: Category with given name exists
  C2.b: Category with given name does not exist
  C2.c: Multiple categories exist but not the target

Category C3 - Database connection
  C3.a: Connection is successfully obtained
  C3.b: Connection fails (SQLException)

Category C4 - SQL execution
  C4.a: DELETE executes successfully (0 or more rows affected)
  C4.b: DELETE fails (SQLException, e.g., foreign key constraint)

2.4.3. Test frames (combinations of choices)

F1: Delete with null name
  - Choices: C1.a
  - Expected behavior: IllegalArgumentException is thrown
  - Exception: IllegalArgumentException with message 
    "Il nome della categoria non può essere null o vuoto"

F2: Delete with empty name
  - Choices: C1.b
  - Expected behavior: IllegalArgumentException is thrown
  - Exception: IllegalArgumentException with message 
    "Il nome della categoria non può essere null o vuoto"

F3: Delete with whitespace-only name
  - Choices: C1.c
  - Expected behavior: IllegalArgumentException is thrown
  - Exception: IllegalArgumentException with message 
    "Il nome della categoria non può essere null o vuoto"

F4: Delete existing category
  - Choices: C1.d + C2.a + C3.a + C4.a
  - Expected behavior: Category is deleted successfully
  - Return value: void (no exception)
  - State: Category no longer exists in database

F5: Delete non-existing category
  - Choices: C1.d + C2.b + C3.a + C4.a
  - Expected behavior: No error, method completes (0 rows affected)
  - Return value: void (silent failure)
  - State: Database unchanged

F6: Delete fails due to foreign key constraint
  - Choices: C1.d + C2.a + C3.a + C4.b
  - Expected behavior: SQLException is thrown
  - Exception: SQLException (foreign key constraint violation)

F7: Database connection fails
  - Choices: C1.d + C3.b
  - Expected behavior: SQLException is thrown
  - Exception: SQLException

2.4.4. Suggested JUnit 5 test method names and structure

shouldThrowIllegalArgumentExceptionWhenNomeIsNull()
  - Arrange: String nome = null;
  - Act & Assert:
    - IllegalArgumentException ex = assertThrows(IllegalArgumentException.class,
        () -> dao.eliminaCategoria(nome))
    - assertEquals("Il nome della categoria non può essere null o vuoto", ex.getMessage())

shouldThrowIllegalArgumentExceptionWhenNomeIsEmpty()
  - Arrange: String nome = "";
  - Act & Assert:
    - IllegalArgumentException ex = assertThrows(IllegalArgumentException.class,
        () -> dao.eliminaCategoria(nome))
    - assertTrue(ex.getMessage().contains("non può essere null o vuoto"))

shouldThrowIllegalArgumentExceptionWhenNomeIsWhitespace()
  - Arrange: String nome = "   ";
  - Act & Assert: assertThrows(IllegalArgumentException.class, 
      () -> dao.eliminaCategoria(nome))

shouldDeleteCategoryWhenValidNameProvided()
  - Arrange:
    - Insert test category "TestCategory"
    - Verify it exists
  - Act: dao.eliminaCategoria("TestCategory");
  - Assert: Verify category no longer exists in database

shouldCompleteWithoutErrorWhenCategoryDoesNotExist()
  - Arrange: Ensure category "NonExistent" does not exist
  - Act: dao.eliminaCategoria("NonExistent");
  - Assert: No exception thrown (assertDoesNotThrow)

shouldThrowSQLExceptionWhenForeignKeyConstraintViolated()
  - Arrange:
    - Insert category referenced by products
  - Act & Assert: assertThrows(SQLException.class, 
      () -> dao.eliminaCategoria("ReferencedCategory"))

2.4.5. Parameterized test candidates

Good candidate for testing various invalid inputs:

CSV schema:
Columns: invalidInput, description
Example rows:
  null, "null value"
  "", "empty string"
  "   ", "whitespace only"
  "\t", "tab character"

================================================================================
### 3. OVERALL TESTING STRATEGY
================================================================================

Integration Testing Considerations:
- All methods require actual database connection
- Consider using in-memory database (H2) or test database
- Use @BeforeEach to set up clean database state
- Use @AfterEach to clean up test data
- Mock ConPool for negative connection tests

Test Data Setup:
- Create test fixtures with known categories
- Use transaction rollback for test isolation
- Consider using DBUnit or similar framework for data management

Coverage Goals:
- All public methods tested
- All exception paths verified
- Boundary conditions covered
- Database integration properly tested

================================================================================
END OF REPORT
================================================================================
