========================================================================
CATEGORY-PARTITION TESTING REPORT
========================================================================
Class: ProdottoCarrello
Package: model.beans
========================================================================

### 1. CLASS OVERVIEW

**Class Name**: ProdottoCarrello
**Package**: model.beans

**Description**:
ProdottoCarrello represents a product item in a shopping cart. It encapsulates a Prodotto (product) reference and its quantity in the cart. This class is responsible for calculating the total price for the item (price * quantity).

**Important Fields**:
- prodotto: Prodotto - Reference to the product
- quantita: int - Quantity of this product in cart

**Invariants** (from JML):
- invariant quantita >= 0
  Quantity must never be negative.

**Design Note**:
The class has both a default constructor (allowing null prodotto initially) and a parameterized constructor that enforces non-null product and valid quantity from creation.

========================================================================
### 2. METHODS TO BE TESTED
========================================================================

2.1 Constructor: ProdottoCarrello()
2.2 Constructor:ProdottoCarrello(Prodotto prodotto, int quantita)
2.3 Method: Prodotto getProdotto()
2.4 Method: void setProdotto(Prodotto prodotto)
2.5 Method: int getQuantita()
2.6 Method: void setQuantita(int quantita)
2.7 Method: double getPrezzoTotale()

========================================================================
### 2.2 Constructor: ProdottoCarrello(Prodotto prodotto, int quantita)
========================================================================

2.2.1. **Parameters and relevant state**

**Parameters**:
- prodotto: Prodotto - The product to add
- quantita: int - The quantity

**Preconditions** (from JML):
- requires prodotto != null
- requires quantita >= 0

**Postconditions**:
- ensures this.prodotto == prodotto && this.quantita == quantita

2.2.2. **Categories and choices**

Category C1 – prodotto parameter
  C1.a: prodotto == null
  C1.b: prodotto != null (valid Prodotto object)

Category C2 – quantita value
  C2.a: quantita < 0 (negative)
  C2.b: quantita == 0 (boundary - zero items)
  C2.c: quantita == 1 (boundary - single item)
  C2.d: quantita > 1 (multiple items)

2.2.3. **Test frames**

F1: Both valid - typical case
  Choices: C1.b + C2.d
  Expected: Object created, fields set

F2: Null product
  Choices: C1.a + (any C2)
  Expected: IllegalArgumentException - "Il prodotto non può essere null"

F3: Negative quantity
  Choices: C1.b + C2.a
  Expected: IllegalArgumentException - "La quantità non può essere negativa"

F4: Zero quantity (boundary valid)
  Choices: C1.b + C2.b
  Expected: Object created successfully (valid edge case - empty cart item)

F5: Single item quantity (boundary valid)
  Choices: C1.b + C2.c
  Expected: Object created successfully

2.2.4. **Suggested tests**

Test Method: shouldCreateProdottoCarrelloWhenBothParametersAreValid()
  Arrange:
    - Prodotto p = new Prodotto()
    - p.setId(1); p.setPrezzo(10.0); p.setMarca("Brand"); p.setModello("Model"); etc.
    - int quantita = 5
  Act: ProdottoCarrello pc = new ProdottoCarrello(p, quantita)
  Assert:
    - assertNotNull(pc)
    - assertEquals(p, pc.getProdotto())
    - assertEquals(5, pc.getQuantita())

Test Method: shouldThrowExceptionWhenProdottoIsNull()
  Arrange: Prodotto p = null, int quantita = 5
  Act & Assert: assertThrows(IllegalArgumentException.class, () -> new ProdottoCarrello(p, quantita))

Test Method: shouldThrowExceptionWhenQuantitaIsNegative()
  Arrange: Prodotto p = createValidProdotto(), int quantita = -1
  Act & Assert: assertThrows(IllegalArgumentException.class, () -> new ProdottoCarrello(p, quantita))

Test Method: shouldCreateProdottoCarrelloWhenQuantitaIsZero()
  Arrange: Prodotto ptest = createValidProdotto(), int quantita = 0
  Act: ProdottoCarrello pc = new ProdottoCarrello(p, quantita)
  Assert: assertEquals(0, pc.getQuantita())

2.2.5. **Parameterized tests**

CSV Schema:
Columns: scenario, productNull, quantita, shouldThrow, expectedQuantita

Example rows:
"valid typical", false, 5, false, 5
"valid zero", false, 0, false, 0
"null product", true, 5, true, null
"negative quantity", false, -1, true, null

========================================================================
### 2.6 Method: void setQuantita(int quantita)
========================================================================

2.6.1. **Parameters and relevant state**

**Parameters**: quantita (int)

**Preconditions** (from JML):
- requires quantita >= 0

**Postconditions**:
- ensures this.quantita == quantita
- Invariant maintained: quantita >= 0

2.6.2. **Categories and choices**

Category C1 – quantita value
  C1.a: quantita < 0
  C1.b: quantita == 0 (boundary)
  C1.c: quantita == 1 (boundary)
  C1.d: quantita > 1

Category C2 – Current state
  C2.a: quantita currently 0
  C2.b: quantita currently positive

2.6.3. **Test frames**

F1: Set negative - should throw
  Choices: C1.a + (any C2)
  Expected: IllegalArgumentException - "La quantità non può essere negativa"

F2: Set to zero from positive
  Choices: C1.b + C2.b
  Expected: Success, quantita becomes 0

F3: Set to positive from zero
  Choices: C1.d + C2.a
  Expected: Success, quantita updated

F4: Update positive to different positive
  Choices: C1.d + C2.b
  Expected: Success, quantita updated

2.6.4. **Suggested tests**

Test Method: shouldThrowExceptionWhenSettingNegativeQuantita()
  Arrange: ProdottoCarrello pc = createValidProdottoCarrello(5)
  Act & Assert: assertThrows(IllegalArgumentException.class, () -> pc.setQuantita(-1))

Test Method: shouldSetQuantitaToZeroWhenValid()
  Arrange: ProdottoCarrello pc = createValidProdottoCarrello(5)
  Act: pc.setQuantita(0)
  Assert: assertEquals(0, pc.getQuantita())

Test Method: shouldUpdateQuantitaToNewPositiveValue()
  Arrange: ProdottoCarrello pc = createValidProdottoCarrello(5)
  Act: pc.setQuantita(10)
  Assert: assertEquals(10, pc.getQuantita())

========================================================================
### 2.7 Method: double getPrezzoTotale()
========================================================================

2.7.1. **Parameters and relevant state**

**Parameters**: None

**Relevant object state**:
- prodotto (must not be null for calculation)
- prodotto.getPrezzo() (price per unit)
- quantita (number of units)

**Preconditions** (from JML):
- requires prodotto != null

**Postconditions** (from JML):
- ensures \result == prodotto.getPrezzo() * quantita

**Implementation note**:
Throws IllegalStateException if prodotto is null.

2.7.2. **Categories and choices**

Category C1 – prodotto state
  C1.a: prodotto == null (from default constructor, not yet set)
  C1.b: prodotto != null

Category C2 – prodotto.getPrezzo() value (when prodotto not null)
  C2.a: prezzo == 0.0 (free product)
  C2.b: prezzo > 0.0 (normal case)

Category C3 – quantita value
  C3.a: quantita == 0
  C3.b: quantita == 1
  C3.c: quantita > 1

2.7.3. **Test frames**

F1: prodotto is null
  Choices: C1.a
  Expected: IllegalStateException - "Impossibile calcolare il prezzo totale: prodotto non impostato"

F2: Zero quantity (total = 0 regardless of price)
  Choices: C1.b + C2.b + C3.a
  Expected: result = 0.0

F3: Single item with normal price
  Choices: C1.b + C2.b + C3.b
  Expected: result = prodotto.getPrezzo() * 1

F4: Multiple items with normal price
  Choices: C1.b + C2.b + C3.c
  Expected: result = prodotto.getPrezzo() * quantita

F5: Free product (price = 0) with multiple items
  Choices: C1.b + C2.a + C3.c
  Expected: result = 0.0

2.7.4. **Suggested tests**

Test Method: shouldThrowExceptionWhenCalculatingPrezzoTotaleWithNullProdotto()
  Arrange: ProdottoCarrello pc = new ProdottoCarrello()
  Act & Assert: assertThrows(IllegalStateException.class, () -> pc.getPrezzoTotale())

Test Method: shouldReturnZeroWhenQuantitaIsZero()
  Arrange: 
    - Prodotto p = createProdottoWithPrice(10.0)
    - ProdottoCarrello pc = new ProdottoCarrello(p, 0)
  Act: double total = pc.getPrezzoTotale()
  Assert: assertEquals(0.0, total)

Test Method: shouldCalculateCorrectTotalForSingleItem()
  Arrange: 
    - Prodotto p = createProdottoWithPrice(10.0)
    - ProdottoCarrello pc = new ProdottoCarrello(p, 1)
  Act: double total = pc.getPrezzoTotale()
  Assert: assertEquals(10.0, total)

Test Method: shouldCalculateCorrectTotalForMultipleItems()
  Arrange:
    - Prodotto p = createProdottoWithPrice(10.0)
    - ProdottoCarrello pc = new ProdottoCarrello(p, 5)
  Act: double total = pc.getPrezzoTotale()
  Assert: assertEquals(50.0, total)

Test Method: shouldReturnZeroForFreeProductWithMultipleItems()
  Arrange:
    - Prodotto p = createProdottoWithPrice(0.0)
    - ProdottoCarrello pc = new ProdottoCarrello(p, 10)
  Act: double total = pc.getPrezzoTotale()
  Assert: assertEquals(0.0, total)

2.7.5. **Parameterized tests**

Excellent candidate.

CSV Schema:
Columns: scenario, productPrice, quantita, productNull, shouldThrow, expectedTotal

Example rows:
"null product", 0.0, 5, true, true, null
"zero quantity", 10.0, 0, false, false, 0.0
"single item", 10.0, 1, false,false, 10.0
"multiple items", 10.0, 5, false, false, 50.0
"free product", 0.0, 5, false, false, 0.0
"decimal price", 9.99, 3, false, false, 29.97

========================================================================
END OF REPORT
========================================================================
